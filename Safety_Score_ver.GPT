import pandas as pd

# 데이터 프레임을 저장할 딕셔너리 생성
dfs = {}

num = [19, 20, 21, 22, 23]
for i in num:
    dfs['df20{}'.format(i)] = pd.read_excel("/content/★2019~2023 학교안전사고 데이터_수정.xlsx", header=0, sheet_name='20'+str(i))

    institutes = dfs['df20{}'.format(i)]['교육청'].unique()

    for institute in institutes:
        score_column_name = 'df20{}_{}_score'.format(i, institute)
        dfs[score_column_name] = 0

        cond = dfs['df20{}'.format(i)]['교육청'] == institute
        injuries = ['머리(두부)', '치아(구강)', '흉복부', '팔', '다리', '손', '발', '기타']
        scores = [1.87, 0.13, 1.25, 0.15, 0.15, 0.15, 0.15, 0.33]

        for index, row in dfs['df20{}'.format(i)][cond].iterrows():
            injury_type = row.iloc[13]  # 13번째 열에 해당하는 사고부위

            for j in range(len(injuries)):
                if injury_type == injuries[j]:
                    dfs[score_column_name] += scores[j]
                    break  # 사고부위가 일치할 경우 점수 더하고 반복문 종료

# 각 교육청 별로 전년도와 점수를 빼는 반복문
for i in range(len(num)-1):
    current_year = num[i+1]
    previous_year = num[i]

    for institute in institutes:
        current_score_column = 'df20{}_{}_score'.format(current_year, institute)
        previous_score_column = 'df20{}_{}_score'.format(previous_year, institute)

        # 점수 계산
        score_difference = dfs[previous_score_column] - dfs[current_score_column]

        # 결과 출력 혹은 저장
        print(f"{institute}의 20{current_year}년도 개선점수: {score_difference}")
